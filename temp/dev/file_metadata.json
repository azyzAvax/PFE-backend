[{"filename": "usp_od_t_opt_unit_gen_occto_hal_usp.sql", "content": "```sql\nCREATE OR REPLACE PROCEDURE USP_OD_T_OPT_UNIT_GEN_OCCTO_HALFHOUR()\nRETURNS OBJECT\nLANGUAGE JAVASCRIPT\nEXECUTE AS CALLER\nAS\n$$\ntry {\n    // Start transaction\n    snowflake.execute({ sqlText: 'BEGIN;' });\n    \n    // Use the appropriate schema\n    snowflake.execute({ sqlText: 'USE SCHEMA TRZ_VC_OPT;' });\n\n    // Step 1: Data Extraction\n    // Extract data from the source table into the temporary table\n    snowflake.execute({ sqlText: `\n        INSERT INTO tmp_str_dl_t_opt_unit_gen_occto_halfhour_01\n        SELECT plant_code, area_code, area_name, plant_name, unit_name, gen_class, target_date,\n               gen_0030_value, gen_0100_value, gen_0130_value, gen_0200_value, gen_0230_value,\n               gen_0300_value, gen_0330_value, gen_0400_value, gen_0430_value, gen_0500_value,\n               gen_0530_value, gen_0600_value, gen_0630_value, gen_0700_value, gen_0730_value,\n               gen_0800_value, gen_0830_value, gen_0900_value, gen_0930_value, gen_1000_value,\n               gen_1030_value, gen_1100_value, gen_1130_value, gen_1200_value, gen_1230_value,\n               gen_1300_value, gen_1330_value, gen_1400_value, gen_1430_value, gen_1500_value,\n               gen_1530_value, gen_1600_value, gen_1630_value, gen_1700_value, gen_1730_value,\n               gen_1800_value, gen_1830_value, gen_1900_value, gen_1930_value, gen_2000_value,\n               gen_2030_value, gen_2100_value, gen_2130_value, gen_2200_value, gen_2230_value,\n               gen_2300_value, gen_2330_value, gen_2400_value, gen_daily_value, source_update_at,\n               url_text, product_id, ubis_data_id, ind_name, ind_jpn_name, unit, data_creator_id,\n               data_creator_name, process_flag, aggregation_unit, cale_id, cale_name, if_id,\n               if_file_name, if_row_number, created_by, create_at, update_at, process_at, process_id\n        FROM dlz.dl_t_opt_unit_gen_occto_halfhour\n        WHERE <conditions>;\n    ` });\n\n    // Step 2: Validation - NULL Check\n    // Call the stored procedure for NULL validation\n    snowflake.execute({ sqlText: `\n        CALL USP_SUB_NULL_VALIDATION('tmp_str_dl_t_opt_unit_gen_occto_halfhour_01', 'dlz', \n        'od_t_opt_unit_gen_occto_halfhour', 'TRZ_VC_OPT', 'USP_OD_T_OPT_UNIT_GEN_OCCTO_HALFHOUR', 'TRZ_VC_OPT');\n    ` });\n\n    // Step 3: Validation - Data Type Check\n    // Call the stored procedure for data type validation\n    snowflake.execute({ sqlText: `\n        CALL USP_SUB_TYPE_DIGIT_VALIDATION('tmp_str_dl_t_opt_unit_gen_occto_halfhour_01', 'dlz', \n        'od_t_opt_unit_gen_occto_halfhour', 'TRZ_VC_OPT', 'USP_OD_T_OPT_UNIT_GEN_OCCTO_HALFHOUR', 'TRZ_VC_OPT');\n    ` });\n\n    // Step 4: Validation - Duplication Check\n    // Call the stored procedure for duplication validation\n    snowflake.execute({ sqlText: `\n        CALL USP_SUB_DUPLICATION_VALIDATION('tmp_str_dl_t_opt_unit_gen_occto_halfhour_01', 'dlz', \n        'USP_OD_T_OPT_UNIT_GEN_OCCTO_HALFHOUR', 'TRZ_VC_OPT');\n    ` });\n\n    // Step 5: Merging/Updating Data\n    // Merge the data from the temporary table into the target table\n    snowflake.execute({ sqlText: `\n        MERGE INTO od_t_opt_unit_gen_occto_halfhour AS target\n        USING tmp_str_dl_t_opt_unit_gen_occto_halfhour_01 AS source\n        ON (target.plant_code = source.plant_code AND target.unit_name = source.unit_name \n            AND target.target_date = source.target_date)\n        WHEN MATCHED THEN UPDATE SET \n            target.area_code = source.area_code,\n            target.area_name = source.area_name,\n            target.plant_name = source.plant_name,\n            target.gen_class = source.gen_class,\n            target.gen_0030_value = source.gen_0030_value,\n            target.gen_0100_value = source.gen_0100_value,\n            target.gen_0130_value = source.gen_0130_value,\n            target.gen_0200_value = source.gen_0200_value,\n            target.gen_0230_value = source.gen_0230_value,\n            target.gen_0300_value = source.gen_0300_value,\n            target.gen_0330_value = source.gen_0330_value,\n            target.gen_0400_value = source.gen_0400_value,\n            target.gen_0430_value = source.gen_0430_value,\n            target.gen_0500_value = source.gen_0500_value,\n            target.gen_0530_value = source.gen_0530_value,\n            target.gen_0600_value = source.gen_0600_value,\n            target.gen_0630_value = source.gen_0630_value,\n            target.gen_0700_value = source.gen_0700_value,\n            target.gen_0730_value = source.gen_0730_value,\n            target.gen_0800_value = source.gen_0800_value,\n            target.gen_0830_value = source.gen_0830_value,\n            target.gen_0900_value = source.gen_0900_value,\n            target.gen_0930_value = source.gen_0930_value,\n            target.gen_1000_value = source.gen_1000_value,\n            target.gen_1030_value = source.gen_1030_value,\n            target.gen_1100_value = source.gen_1100_value,\n            target.gen_1130_value = source.gen_1130_value,\n            target.gen_1200_value = source.gen_1200_value,\n            target.gen_1230_value = source.gen_1230_value,\n            target.gen_1300_value = source.gen_1300_value,\n            target.gen_1330_value = source.gen_1330_value,\n            target.gen_1400_value = source.gen_1400_value,\n            target.gen_1430_value = source.gen_1430_value,\n            target.gen_1500_value = source.gen_1500_value,\n            target.gen_1530_value = source.gen_1530_value,\n            target.gen_1600_value = source.gen_1600_value,\n            target.gen_1630_value = source.gen_1630_value,\n            target.gen_1700_value = source.gen_1700_value,\n            target.gen_1730_value = source.gen_1730_value,\n            target.gen_1800_value = source.gen_1800_value,\n            target.gen_1830_value = source.gen_1830_value,\n            target.gen_1900_value = source.gen_1900_value,\n            target.gen_1930_value = source.gen_1930_value,\n            target.gen_2000_value = source.gen_2000_value,\n            target.gen_2030_value = source.gen_2030_value,\n            target.gen_2100_value = source.gen_2100_value,\n            target.gen_2130_value = source.gen_2130_value,\n            target.gen_2200_value = source.gen_2200_value,\n            target.gen_2230_value = source.gen_2230_value,\n            target.gen_2300_value = source.gen_2300_value,\n            target.gen_2330_value = source.gen_2330_value,\n            target.gen_2400_value = source.gen_2400_value,\n            target.gen_daily_value = source.gen_daily_value,\n            target.source_update_at = source.source_update_at,\n            target.url_text = source.url_text,\n            target.product_id = source.product_id,\n            target.ubis_data_id = source.ubis_data_id,\n            target.ind_name = source.ind_name,\n            target.ind_jpn_name = source.ind_jpn_name,\n            target.unit = source.unit,\n            target.data_creator_id = source.data_creator_id,\n            target.data_creator_name = source.data_creator_name,\n            target.process_flag = source.process_flag,\n            target.aggregation_unit = source.aggregation_unit,\n            target.cale_id = source.cale_id,\n            target.cale_name = source.cale_name,\n            target.if_id = source.if_id,\n            target.if_file_name = source.if_file_name,\n            target.if_row_number = source.if_row_number,\n            target.created_by = source.created_by;\n    ` });\n\n    // Step 6: Cleanup\n    // Drop the temporary table after processing\n    snowflake.execute({ sqlText: 'DROP TABLE IF EXISTS tmp_str_dl_t_opt_unit_gen_occto_halfhour_01;' });\n\n    // Commit the transaction\n    snowflake.execute({ sqlText: 'COMMIT;' });\n\n    return { \"status\": \"SUCCESS\" };\n}\ncatch (err) {\n    // Rollback the transaction in case of error\n    snowflake.execute({ sqlText: 'ROLLBACK;' });\n    throw err;\n}\n$$;\n```", "object_type": "procedure", "context": "trz", "ddl_path": "temp\\dev\\snowflake\\dataplatform\\ddl\\trz\\70_procedure\\usp_od_t_opt_unit_gen_occto_hal_usp.sql", "project_ddl_path": "", "dcl_path": "", "project_dcl_path": "", "prefix": "70"}, {"filename": "dl_t_opt_incon_avail_cap_yea_pl_generated.sql", "content": "CREATE TABLE dlz.\u9023\u7cfb\u7dda_\u7a7a\u5bb9\u91cf_\u5e74\u9593\u8a08\u753b (\n    target_class VARCHAR COMMENT '\u5bfe\u8c61\u65ad\u9762',\n    formulate_year VARCHAR COMMENT '\u7b56\u5b9a\u5e74\u5ea6\uff0f\u5e74',\n    updated_class VARCHAR COMMENT '\u7b56\u5b9a\uff0f\u66f4\u65b0\u5f8c',\n    interconn_name VARCHAR COMMENT '\u9023\u7cfb\u7dda',\n    target_date VARCHAR COMMENT '\u5e74\u6708\u65e5',\n    timeframe_value VARCHAR COMMENT '\u663c\uff0f\u591c',\n    dirct_value VARCHAR COMMENT '\u65b9\u5411',\n    avail_cap_min_value VARCHAR COMMENT '\u7a7a\u5bb9\u91cf\u6700\u5c0f',\n    avail_cap_max_value VARCHAR COMMENT '\u7a7a\u5bb9\u91cf\u6700\u5927',\n    plan_load_flow_value VARCHAR COMMENT '\u8a08\u753b\u6f6e\u6d41',\n    margin_b_max_value VARCHAR COMMENT '\u30de\u30fc\u30b8\u30f3A\u6700\u5927',\n    margin_a_min_value VARCHAR COMMENT '\u30de\u30fc\u30b8\u30f3A\u6700\u5c0f',\n    margin_b_value VARCHAR COMMENT '\u30de\u30fc\u30b8\u30f3B',\n    grid_cap_value VARCHAR COMMENT '\u904b\u7528\u5bb9\u91cf',\n    grid_cap_detrmt_text VARCHAR COMMENT '\u904b\u7528\u5bb9\u91cf\u6c7a\u5b9a\u8981\u56e0',\n    enlarge_plan_load_flow_value VARCHAR COMMENT '\u904b\u7528\u5bb9\u91cf\u62e1\u5927\u5206\u7a7a\u5bb9\u91cf',\n    enlarge_grid_cap_value VARCHAR COMMENT '\u904b\u7528\u5bb9\u91cf\u62e1\u5927\u5206\u904b\u7528\u5bb9\u91cf',\n    supply_ng_number VARCHAR COMMENT '\u9001\u96fbNG\u60c5\u5831\u4ef6\u6570',\n    supply_ng_stated_cap_value VARCHAR COMMENT '\u9001\u96fbNG\u60c5\u5831\u5ef6\u3079\u5bb9\u91cf',\n    source_update_at VARCHAR COMMENT '\u6700\u65b0\u66f4\u65b0\u5e74\u6708\u65e5\u6642\u523b',\n    url_text VARCHAR COMMENT '\u8af8\u5143\u306eURL',\n    product_id VARCHAR COMMENT '\u30c7\u30fc\u30bf\u306e\u8b58\u5225\u5b50',\n    if_id VARCHAR COMMENT '\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9ID',\n    if_file_name VARCHAR(255) NOT NULL COMMENT 'IF\u30d5\u30a1\u30a4\u30eb\u540d',\n    if_row_number NUMBER(38,0) NOT NULL COMMENT 'IF\u884c\u756a\u53f7',\n    created_by VARCHAR COMMENT '\u4f5c\u6210\u8005',\n    create_at TIMESTAMP_LTZ(7) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u306e\u4f5c\u6210\u65e5\u6642',\n    update_at TIMESTAMP_LTZ(7) COMMENT '\u30ec\u30b3\u30fc\u30c9\u306e\u66f4\u65b0\u65e5\u6642',\n    process_at TIMESTAMP_LTZ(7) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u4f5c\u6210\uff0f\u66f4\u65b0\u51e6\u7406\u306e\u5b9f\u884c\u65e5\u6642',\n    process_id VARCHAR(255) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u4f5c\u6210\uff0f\u66f4\u65b0\u51e6\u7406\u3092\u7279\u5b9a\u3059\u308bID',\n    PRIMARY KEY (if_file_name, if_row_number)\n) DATA_RETENTION_TIME_IN_DAYS = 30 COMMENT 'OCCTO\u304b\u3089\u53d6\u5f97\u3057\u305f\u9023\u7cfb\u7dda\u306e\u6708\u9593\u65ad\u9762\u306e\u7a7a\u5bb9\u91cf\u306e\u8a08\u753b(\u7b56\u5b9a/\u66f4\u65b0\u5f8c)\u3092\u683c\u7d0d\u3059\u308b\u30c6\u30fc\u30d6\u30eb';", "object_type": "table", "context": "dlz", "ddl_path": "temp\\dev\\snowflake\\dataplatform\\ddl\\dlz\\20_table\\dl_t_opt_incon_avail_cap_yea_pl_generated.sql", "project_ddl_path": "", "dcl_path": "temp\\dev\\snowflake\\dataplatform\\dcl\\dlz\\20_table\\dl_t_opt_incon_avail_cap_yea_pl_generated.sql", "project_dcl_path": "", "prefix": "20"}, {"filename": "dl_t_opt_interconn_load_flow_ac_generated.sql", "content": "CREATE TABLE dlz.dl_t_opt_interconn_load_flow_actl (\n    interconn_name VARCHAR COMMENT '\u9023\u7cfb\u7dda\u306e\u540d\u79f0',\n    target_date VARCHAR COMMENT '\u6f6e\u6d41\u5b9f\u7e3e\u306e\u5bfe\u8c61\u65e5',\n    target_time_text VARCHAR COMMENT '\u6f6e\u6d41\u5b9f\u7e3e\u306e\u5bfe\u8c61\u6642\u523b',\n    forward_grid_cap_value VARCHAR COMMENT '\u9023\u7cfb\u7dda\uff08\u9806\u65b9\u5411\uff09\u306b\u6d41\u305b\u308b\u96fb\u529b\u91cf\uff08\u6f6e\u6d41\uff09\u306e\u4e0a\u9650\u5024',\n    reverse_grid_cap_value VARCHAR COMMENT '\u9023\u7cfb\u7dda\uff08\u9006\u65b9\u5411\uff09\u306b\u6d41\u305b\u308b\u96fb\u529b\u91cf\uff08\u6f6e\u6d41\uff09\u306e\u4e0a\u9650\u5024',\n    forward_wide_area_adjst_value VARCHAR COMMENT '\u96fb\u529b\u9700\u7d66\u30d0\u30e9\u30f3\u30b9\u3092\u5e83\u57df\u7684\u306b\u8abf\u6574\u3059\u308b\u529b\uff08\u9806\u65b9\u5411\uff09',\n    reverse_wide_area_adjst_value VARCHAR COMMENT '\u96fb\u529b\u9700\u7d66\u30d0\u30e9\u30f3\u30b9\u3092\u5e83\u57df\u7684\u306b\u8abf\u6574\u3059\u308b\u529b\uff08\u9006\u65b9\u5411\uff09',\n    forward_margin_value VARCHAR COMMENT '\u9023\u7cfb\u7dda\uff08\u9806\u65b9\u5411\uff09\u3092\u901a\u3058\u3066\u3001\u96fb\u529b\u306e\u9700\u7d66\u30d0\u30e9\u30f3\u30b9\u3092\u5e83\u57df\u7684\u306b\u8abf\u6574\u3059\u308b\u305f\u3081\u306b\u8a2d\u5b9a\u3055\u308c\u308b\u5bb9\u91cf\u67a0',\n    reverse_margin_value VARCHAR COMMENT '\u9023\u7cfb\u7dda\uff08\u9006\u65b9\u5411\uff09\u3092\u901a\u3058\u3066\u3001\u96fb\u529b\u306e\u9700\u7d66\u30d0\u30e9\u30f3\u30b9\u3092\u5e83\u57df\u7684\u306b\u8abf\u6574\u3059\u308b\u305f\u3081\u306b\u8a2d\u5b9a\u3055\u308c\u308b\u5bb9\u91cf\u67a0',\n    forward_avail_cap_value VARCHAR COMMENT '\u4e0d\u6e2c\u306e\u4e8b\u614b\u306e\u88d5\u5ea6\u3068\u3057\u3066\u4e88\u3081\u78ba\u4fdd\u3057\u3066\u3044\u308b\u9023\u7cfb\u7dda\uff08\u9806\u65b9\u5411\uff09\u306e\u904b\u7528\u5bb9\u91cf',\n    reverse_avail_cap_value VARCHAR COMMENT '\u4e0d\u6e2c\u306e\u4e8b\u614b\u306e\u88d5\u5ea6\u3068\u3057\u3066\u4e88\u3081\u78ba\u4fdd\u3057\u3066\u3044\u308b\u9023\u7cfb\u7dda\uff08\u9006\u65b9\u5411\uff09\u306e\u904b\u7528\u5bb9\u91cf',\n    forward_plan_load_flow_value VARCHAR COMMENT '\u9023\u7cfb\u7dda\uff08\u9806\u65b9\u5411\uff09\u306b\u6d41\u3059\u96fb\u529b\u91cf\u306e\u8a08\u753b\u5024',\n    reverse_plan_load_flow_value VARCHAR COMMENT '\u9023\u7cfb\u7dda\uff08\u9006\u65b9\u5411\uff09\u306b\u6d41\u3059\u96fb\u529b\u91cf\u306e\u8a08\u753b\u5024',\n    load_flow_value VARCHAR COMMENT '\u9023\u7cfb\u7dda\u306b\u6d41\u3057\u305f\u96fb\u529b\u91cf\u306e\u5b9f\u7e3e\u5024',\n    forward_enlarge_grid_cap_value VARCHAR COMMENT '\u7dca\u6025\u6642\u306b\u304a\u3044\u3066\u5e83\u3052\u308b\u3053\u3068\u304c\u53ef\u80fd\u306a\u9023\u7cfb\u7dda\uff08\u9806\u65b9\u5411\uff09\u306e\u904b\u7528\u5bb9\u91cf',\n    reverse_enlarge_grid_cap_value VARCHAR COMMENT '\u7dca\u6025\u6642\u306b\u304a\u3044\u3066\u5e83\u3052\u308b\u3053\u3068\u304c\u53ef\u80fd\u306a\u9023\u7cfb\u7dda\uff08\u9006\u65b9\u5411\uff09\u306e\u904b\u7528\u5bb9\u91cf',\n    url_text VARCHAR COMMENT '\u8af8\u5143\u306eURL',\n    product_id VARCHAR COMMENT '\u30c7\u30fc\u30bf\u306e\u8b58\u5225\u5b50',\n    if_id VARCHAR COMMENT '\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9ID',\n    if_file_name VARCHAR(255) NOT NULL COMMENT 'IF\u30d5\u30a1\u30a4\u30eb\u540d',\n    if_row_number NUMBER(38,0) NOT NULL COMMENT 'IF\u884c\u756a\u53f7',\n    created_by VARCHAR COMMENT '\u30ec\u30b3\u30fc\u30c9\u306e\u4f5c\u6210\u8005',\n    create_at TIMESTAMP_LTZ(7) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u306e\u4f5c\u6210\u65e5\u6642',\n    update_at TIMESTAMP_LTZ(7) COMMENT '\u30ec\u30b3\u30fc\u30c9\u306e\u66f4\u65b0\u65e5\u6642',\n    process_at TIMESTAMP_LTZ(7) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u4f5c\u6210\uff0f\u66f4\u65b0\u51e6\u7406\u306e\u5b9f\u884c\u65e5\u6642',\n    process_id VARCHAR(255) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u4f5c\u6210\uff0f\u66f4\u65b0\u51e6\u7406\u3092\u7279\u5b9a\u3059\u308bID',\n    PRIMARY KEY (interconn_name, target_date, target_time_text)\n) WITH DATA_RETENTION_TIME_IN_DAYS = 30;", "object_type": "table", "context": "dlz", "ddl_path": "temp\\dev\\snowflake\\dataplatform\\ddl\\dlz\\20_table\\dl_t_opt_interconn_load_flow_ac_generated.sql", "project_ddl_path": "", "dcl_path": "temp\\dev\\snowflake\\dataplatform\\dcl\\dlz\\20_table\\dl_t_opt_interconn_load_flow_ac_generated.sql", "project_dcl_path": "", "prefix": "20"}, {"filename": "usp_od_t_opt_plant_ope_state_usp.sql", "content": "```sql\nCREATE OR REPLACE PROCEDURE USP_OD_T_OPT_PLANT_OPE_STATE()\nRETURNS OBJECT\nLANGUAGE JAVASCRIPT\nEXECUTE AS CALLER\nAS\n$$\ntry {\n    // Start transaction\n    snowflake.execute({ sqlText: 'BEGIN;' });\n    // Use the appropriate schema\n    snowflake.execute({ sqlText: 'USE SCHEMA dlz;' });\n\n    // Step 1: Data Extraction\n    // Insert data from the source stream into the temporary table where the action is 'INSERT'\n    snowflake.execute({ sqlText: 'INSERT INTO dlz.tmp_str_dl_t_opt_plant_ope_state_01 SELECT * FROM dlz.str_dl_t_opt_plant_ope_state_01 WHERE METADATA$ACTION = \\'INSERT\\';' });\n\n    // Step 2: Metadata Assignment\n    // Call the metadata assignment procedure\n    snowflake.execute({ sqlText: 'CALL rfz_vc_opt.usp_sub_common_mtdata(\\'dlz\\', \\'tmp_str_dl_t_opt_plant_ope_state_01\\', \\'rfz_vc_opt\\', \\'dw_v_opt_supply_deman_ext_ind_mgmt\\', \\'[\\\"if_id\\\", \\\"product_id\\\"]\\', \\'[\\\"area_name\\\"]\\', TO_VARCHAR(CURRENT_DATE(), \\'YYYY/MM/DD\\'), \\'USP_OD_T_OPT_PLANT_OPE_STATE\\', \\'dlz\\');' });\n\n    // Step 3: Validation - NULL Check\n    // Call the null validation procedure\n    snowflake.execute({ sqlText: 'CALL trz_vc_opt.usp_sub_null_validation(\\'tmp_str_dl_t_opt_plant_ope_state_01\\', \\'dlz\\', \\'od_t_opt_plant_ope_state\\', \\'trz_vc_opt\\', \\'USP_OD_T_OPT_PLANT_OPE_STATE\\', \\'dlz\\');' });\n\n    // Step 4: Validation - Data Type Check\n    // Call the data type validation procedure\n    snowflake.execute({ sqlText: 'CALL trz_vc_opt.usp_sub_type_digit_validation(\\'tmp_str_dl_t_opt_plant_ope_state_01\\', \\'dlz\\', \\'od_t_opt_plant_ope_state\\', \\'trz_vc_opt\\', \\'USP_OD_T_OPT_PLANT_OPE_STATE\\', \\'dlz\\');' });\n\n    // Step 5: Validation - Duplication Check\n    // Call the duplication validation procedure\n    snowflake.execute({ sqlText: 'CALL trz_vc_opt.usp_sub_duplication_validation(\\'tmp_str_dl_t_opt_plant_ope_state_01\\', \\'dlz\\', \\'[\\\"plant_id\\\", \\\"unit_name\\\", \\\"stop_datetime\\\"]\\', \\'USP_OD_T_OPT_PLANT_OPE_STATE\\', \\'dlz\\');' });\n\n    // Step 6: Data Insertion\n    // Delete old records and insert new data into the target table\n    snowflake.execute({ sqlText: 'DELETE FROM trz_vc_opt.od_t_opt_plant_ope_state WHERE process_at < DATEADD(month, -1, CURRENT_DATE());' });\n    snowflake.execute({ sqlText: 'INSERT INTO trz_vc_opt.od_t_opt_plant_ope_state (section_datetime, area_name, generation_company_name, plant_id, plant_name, generation_type_text, unit_name, auth_output_value, stop_class, type_name, decrease_value, stop_datetime, sfr_forecast_text, sfr_date, stop_cause_text, last_update_datetime, product_id, ubis_data_id, ind_name, ind_jpn_name, unit, data_creator_id, data_creator_name, process_flag, aggregation_unit, cale_id, cale_name, if_id, if_file_name, if_row_number, created_by, create_at, update_at, process_at, process_id) SELECT TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP()), CAST(area_code AS VARCHAR(2)), CAST(area_name AS VARCHAR(10)), CAST(generation_company_name AS VARCHAR(100)), CAST(plant_id AS VARCHAR(15)), CAST(plant_name AS VARCHAR(150)), CAST(generation_type_text AS VARCHAR(20)), CAST(unit_name AS VARCHAR(50)), CAST(auth_output_value AS NUMBER(17,2)), CAST(stop_class AS VARCHAR(20)), CAST(type_name AS VARCHAR(40)), CAST(decrease_value AS NUMBER(17,2)), TO_TIMESTAMP_NTZ(stop_datetime, \\'YYYY/MM/DD HH24:MI\\'), CAST(sfr_forecast_text AS VARCHAR(10)), TO_DATE(sfr_date, \\'YYYY/MM/DD\\'), CAST(stop_cause_text AS VARCHAR), TO_TIMESTAMP_NTZ(last_update_datetime, \\'YYYY/MM/DD HH24:MI\\'), CAST(product_id AS VARCHAR(255)), CAST(ubis_data_id AS VARCHAR(6)), CAST(ind_name AS VARCHAR(255)), CAST(ind_jpn_name AS VARCHAR(255)), CAST(unit AS VARCHAR(255)), CAST(data_creator_id AS VARCHAR(6)), CAST(data_creator_name AS VARCHAR(255)), CAST(process_flag AS BOOLEAN), CAST(aggregation_unit AS VARCHAR(255)), CAST(cale_id AS VARCHAR(6)), CAST(cale_name AS VARCHAR(255)), CAST(if_id AS VARCHAR(255)), CAST(if_file_name AS VARCHAR(255)), CAST(if_row_number AS NUMBER(38,0)), CAST(created_by AS VARCHAR(255)), CURRENT_TIMESTAMP(), NULL, CURRENT_TIMESTAMP(), \\'USP_OD_T_OPT_PLANT_OPE_STATE\\' FROM dlz.tmp_str_dl_t_opt_plant_ope_state_01;' });\n\n    // Commit the transaction\n    snowflake.execute({ sqlText: 'COMMIT;' });\n\n    return { \"status\": \"SUCCESS\" };\n}\ncatch (err) {\n    // Rollback the transaction in case of error\n    snowflake.execute({ sqlText: 'ROLLBACK;' });\n    throw err;\n}\n$$;\n```", "object_type": "procedure", "context": "trz", "ddl_path": "temp\\dev\\snowflake\\dataplatform\\ddl\\trz\\70_procedure\\usp_od_t_opt_plant_ope_state_usp.sql", "project_ddl_path": "", "dcl_path": "", "project_dcl_path": "", "prefix": "70"}, {"filename": "usp_od_t_opt_power_fut_vanir_usp.sql", "content": "```sql\nCREATE OR REPLACE PROCEDURE trz_vc_opt.usp_sub_power_ind_mtdata()\nRETURNS OBJECT\nLANGUAGE JAVASCRIPT\nEXECUTE AS CALLER\nAS\n$$\ntry {\n    // Start transaction\n    snowflake.execute({ sqlText: 'BEGIN;' });\n    // Use the appropriate schema\n    snowflake.execute({ sqlText: 'USE SCHEMA dlz;' });\n\n    // Step 1: Data Extraction\n    // Create a temporary table to hold extracted data from the source table\n    snowflake.execute({ sqlText: `\n        CREATE OR REPLACE TEMPORARY TABLE dlz.tmp_str_dl_t_opt_power_fut_vanir AS \n        SELECT * \n        FROM dlz.str_dl_t_opt_power_fut_vanir_01 no1 \n        LEFT JOIN rfz_vc_opt.dw_v_opt_power_ind_mgmt_m no3 \n        ON no1.product_id = no3.product_id;` \n    });\n\n    // Step 2: Metadata Assignment\n    // Call the metadata assignment procedure to process the temporary table into the target table\n    snowflake.execute({ sqlText: `\n        CALL trz_vc_opt.usp_sub_power_ind_mtdata(\n            'dlz.tmp_str_dl_t_opt_power_fut_vanir', \n            'dlz', \n            'trz_vc_opt.od_t_opt_power_fut_vanir', \n            'trz_vc_opt', \n            CURRENT_DATE, \n            'usp_od_t_opt_power_fut_vanir'\n        );` \n    });\n\n    // Step 3: Validation\n    // Perform various validation checks on the temporary table\n    snowflake.execute({ sqlText: `\n        CALL trz_vc_opt.usp_sub_null_validation(\n            'tmp_str_dl_t_opt_power_fut_vanir', \n            'dlz', \n            'od_t_opt_power_fut_vanir', \n            'trz_vc_opt', \n            'usp_od_t_opt_power_fut_vanir', \n            'trz_vc_opt'\n        );` \n    });\n    \n    snowflake.execute({ sqlText: `\n        CALL trz_vc_opt.usp_sub_type_digit_validation(\n            'tmp_str_dl_t_opt_power_fut_vanir', \n            'dlz', \n            'od_t_opt_power_fut_vanir', \n            'trz_vc_opt', \n            'usp_od_t_opt_power_fut_vanir', \n            'trz_vc_opt'\n        );` \n    });\n    \n    snowflake.execute({ sqlText: `\n        CALL trz_vc_opt.usp_sub_duplication_validation(\n            'tmp_str_dl_t_opt_power_fut_vanir', \n            'dlz', \n            '[product_id, price_date, deliv_month]', \n            'usp_od_t_opt_power_fut_vanir', \n            'trz_vc_opt'\n        );` \n    });\n\n    // Step 4: Update\n    // Merge the temporary table data into the target table\n    snowflake.execute({ sqlText: `\n        MERGE INTO trz_vc_opt.od_t_opt_power_fut_vanir AS target \n        USING (SELECT * FROM dlz.tmp_str_dl_t_opt_power_fut_vanir) AS source \n        ON (target.product_id = source.product_id \n            AND target.price_date = TO_DATE(source.price_date, 'YYYY/MM/DD') \n            AND target.deliv_month = TO_DATE(source.deliv_month, 'YYYY/MM/DD')) \n        WHEN MATCHED THEN \n            UPDATE SET target.price_value = source.price_value, \n                        target.data_class = source.data_class \n        WHEN NOT MATCHED THEN \n            INSERT (product_id, price_date, deliv_month, price_value, data_class) \n            VALUES (source.product_id, source.price_date, source.deliv_month, source.price_value, source.data_class);` \n    });\n\n    // Commit the transaction\n    snowflake.execute({ sqlText: 'COMMIT;' });\n\n    return { \"status\": \"SUCCESS\" };\n}\ncatch (err) {\n    // Rollback the transaction in case of error\n    snowflake.execute({ sqlText: 'ROLLBACK;' });\n    throw err;\n}\n$$;\n```", "object_type": "procedure", "context": "trz", "ddl_path": "temp\\dev\\snowflake\\dataplatform\\ddl\\trz\\70_procedure\\usp_od_t_opt_power_fut_vanir_usp.sql", "project_ddl_path": "", "dcl_path": "", "project_dcl_path": "", "prefix": "70"}, {"filename": "od_t_opt_cap_mark_area_cont_rsl_generated.sql", "content": "CREATE TABLE trz_vc_opt.od_t_opt_power_cap_market_by_area_auc_cont_rslt (\n    cont_rslt_rls_date DATE NOT NULL COMMENT '\u7d04\u5b9a\u7d50\u679c\u306e\u516c\u8868\u65e5',\n    target_fiscal_year NUMBER(4,0) NOT NULL COMMENT '\u5bfe\u8c61\u5b9f\u9700\u7d66\u5e74\u5ea6',\n    auc_type_name VARCHAR(255) NOT NULL COMMENT '\u30e1\u30a4\u30f3\u30aa\u30fc\u30af\u30b7\u30e7\u30f3 / \u8ffd\u52a0\u30aa\u30fc\u30af\u30b7\u30e7\u30f3 \u7b49\u306e\u7a2e\u5225',\n    area_code VARCHAR(2) NOT NULL COMMENT 'TSO\u306e\u4f9b\u7d66\u533a\u57df\u3092\u793a\u3059\u30b3\u30fc\u30c9',\n    area_name VARCHAR(255) COMMENT 'TSO\u306e\u4f9b\u7d66\u533a\u57df\u306e\u540d\u79f0',\n    area_unitprice NUMBER(38,2) COMMENT '\u30a8\u30ea\u30a2\u6bce\u306e\u5358\u4fa1',\n    cont_cap_volume NUMBER(38,2) COMMENT '\u30a8\u30ea\u30a2\u6bce\u306e\u7d04\u5b9a\u5bb9\u91cf',\n    after_ded_cont_ttl_amount NUMBER(38,2) COMMENT '\u7d4c\u904e\u63aa\u7f6e\u63a7\u9664\u3092\u53cd\u6620\u3055\u305b\u305f\u3001\u30a8\u30ea\u30a2\u6bce\u306e\u7d04\u5b9a\u7dcf\u984d',\n    url_text VARCHAR COMMENT '\u8af8\u5143\u306eURL',\n    product_id VARCHAR(255) COMMENT '\u30c7\u30fc\u30bf\u306e\u8b58\u5225\u5b50',\n    ubis_data_id VARCHAR(6) NOT NULL COMMENT '\u5404\u30c7\u30fc\u30bf\u6307\u6a19\u3092\u8b58\u5225\u3059\u308bID',\n    ind_name VARCHAR(255) NOT NULL COMMENT '\u6307\u6a19\u540d',\n    ind_jpn_name VARCHAR(255) NOT NULL COMMENT '\u6307\u6a19\u540d_\u65e5\u672c\u8a9e',\n    data_creator_id VARCHAR(6) NOT NULL COMMENT '\u30c7\u30fc\u30bf\u8af8\u5143ID',\n    data_creator_name VARCHAR(255) NOT NULL COMMENT '\u30c7\u30fc\u30bf\u8af8\u5143\u540d',\n    process_flag BOOLEAN NOT NULL COMMENT '\u52a0\u5de5\u3057\u305f\u30c7\u30fc\u30bf\u304b\u3092\u5224\u5225',\n    aggregation_unit VARCHAR(255) NOT NULL COMMENT '\u30c7\u30fc\u30bf\u304c\u3069\u306e\u7a0b\u5ea6\u306e\u8a73\u7d30\u5ea6\u3067\u96c6\u8a08\u3055\u308c\u3066\u3044\u308b\u304b\u3092\u8b58\u5225\u3059\u308b',\n    cale_id VARCHAR(6) NOT NULL COMMENT '\u30ab\u30ec\u30f3\u30c0\u30fcID',\n    cale_name VARCHAR(255) NOT NULL COMMENT '\u30ab\u30ec\u30f3\u30c0\u30fc\u540d',\n    if_id VARCHAR(255) NOT NULL COMMENT '\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9ID',\n    if_file_name VARCHAR(255) NOT NULL COMMENT 'IF\u30d5\u30a1\u30a4\u30eb\u540d',\n    if_row_number NUMBER(38,0) NOT NULL COMMENT 'IF\u884c\u756a\u53f7',\n    created_by VARCHAR(255) COMMENT '\u4f5c\u6210\u8005',\n    create_at TIMESTAMP_LTZ(7) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u306e\u4f5c\u6210\u65e5\u6642',\n    update_at TIMESTAMP_LTZ(7) COMMENT '\u30ec\u30b3\u30fc\u30c9\u306e\u66f4\u65b0\u65e5\u6642',\n    process_at TIMESTAMP_LTZ(7) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u4f5c\u6210\uff0f\u66f4\u65b0\u51e6\u7406\u306e\u5b9f\u884c\u65e5\u6642',\n    process_id VARCHAR(255) NOT NULL COMMENT '\u30ec\u30b3\u30fc\u30c9\u4f5c\u6210\uff0f\u66f4\u65b0\u51e6\u7406\u3092\u7279\u5b9a\u3059\u308bID',\n    PRIMARY KEY (cont_rslt_rls_date, target_fiscal_year, auc_type_name, area_code, ubis_data_id)\n) DATA_RETENTION_TIME_IN_DAYS = 30;", "object_type": "table", "context": "trz", "ddl_path": "temp\\dev\\snowflake\\dataplatform\\ddl\\trz\\20_table\\od_t_opt_cap_mark_area_cont_rsl_generated.sql", "project_ddl_path": "", "dcl_path": "temp\\dev\\snowflake\\dataplatform\\dcl\\trz\\20_table\\od_t_opt_cap_mark_area_cont_rsl_generated.sql", "project_dcl_path": "", "prefix": "20"}, {"filename": "dw_v_opt_cap_mark_cont_rsl_late_generated.sql", "content": "CREATE OR REPLACE TABLE rfz_vc_opt.dw_v_opt_power_cap_market_by_area_auc_cont_rslt_latest (\n  ubis_data_id STRING COMMENT '\u30c7\u30fc\u30bfID',\n  ind_name STRING COMMENT '\u6307\u6a19\u540d',\n  ind_jpn_name STRING COMMENT '\u6307\u6a19\u540d_\u65e5\u672c\u8a9e',\n  cont_rslt_rls_date DATE COMMENT '\u7d04\u5b9a\u7d50\u679c\u516c\u8868\u65e5',\n  target_fiscal_year STRING COMMENT '\u5bfe\u8c61\u5b9f\u9700\u7d66\u5e74\u5ea6',\n  auc_type_name STRING COMMENT '\u30aa\u30fc\u30af\u30b7\u30e7\u30f3\u7a2e\u5225',\n  area_code STRING COMMENT '\u30a8\u30ea\u30a2\u30b3\u30fc\u30c9',\n  area_name STRING COMMENT '\u30a8\u30ea\u30a2\u540d',\n  area_unitprice FLOAT COMMENT '\u30a8\u30ea\u30a2\u30d7\u30e9\u30a4\u30b9(\u5186/kW)',\n  cont_cap_volume FLOAT COMMENT '\u7d04\u5b9a\u5bb9\u91cf(kW)',\n  after_ded_cont_ttl_amount FLOAT COMMENT '\u7d04\u5b9a\u7dcf\u984d\uff08\u7d4c\u904e\u63aa\u7f6e\u63a7\u9664\u5f8c\uff09(\u5186)',\n  data_creator_id STRING COMMENT '\u30c7\u30fc\u30bf\u8af8\u5143ID',\n  data_creator_name STRING COMMENT '\u30c7\u30fc\u30bf\u8af8\u5143\u540d',\n  url_text STRING COMMENT 'URL',\n  process_flag STRING COMMENT '\u52a0\u5de5\u30d5\u30e9\u30b0',\n  created_by STRING COMMENT '\u4f5c\u6210\u8005',\n  create_at TIMESTAMP COMMENT '\u4f5c\u6210\u65e5\u6642',\n  update_at TIMESTAMP COMMENT '\u66f4\u65b0\u65e5\u6642',\n  process_at TIMESTAMP COMMENT '\u51e6\u7406\u65e5\u6642',\n  process_id STRING COMMENT '\u51e6\u7406ID'\n) COMMENT = '\u5bb9\u91cf\u5e02\u5834_\u30a8\u30ea\u30a2\u5225_\u30aa\u30fc\u30af\u30b7\u30e7\u30f3\u7d04\u5b9a\u7d50\u679c_\u6700\u65b0\u65ad\u9762' \nDATA_RETENTION_TIME_IN_DAYS = 30;", "object_type": "view", "context": "rfz", "ddl_path": "temp\\dev\\snowflake\\dataplatform\\ddl\\rfz\\50_view\\dw_v_opt_cap_mark_cont_rsl_late_generated.sql", "project_ddl_path": "temp\\dev\\snowflake\\my_project\\ddl\\rfz\\50_view\\dw_v_opt_cap_mark_cont_rsl_late_generated.sql", "dcl_path": "temp\\dev\\snowflake\\dataplatform\\dcl\\rfz\\50_view\\dw_v_opt_cap_mark_cont_rsl_late_generated.sql", "project_dcl_path": "temp\\dev\\snowflake\\my_project\\dcl\\rfz\\50_view\\dw_v_opt_cap_mark_cont_rsl_late_generated.sql", "prefix": "50"}]